{"version":3,"file":"576.bundle.js","mappings":"qOAoBA,MA2JA,EA3J6BA,KAC3B,MAAOC,EAASC,IAAcC,EAAAA,EAAAA,WAAS,IAChCC,EAAWC,IAAgBF,EAAAA,EAAAA,UAAyB,KACpDG,EAAYC,IAAiBJ,EAAAA,EAAAA,UAAS,IAGvCK,EAAiBC,UACrBP,GAAW,GACX,IACE,MAAMQ,QAAiBC,EAAAA,EAAQC,IAAI,UACnCC,QAAQC,IAAI,gBAAiBJ,EAASK,MAEX,MAAvBL,EAASK,KAAKC,KAChBX,EAAaK,EAASK,KAAKA,MAE3BE,EAAAA,GAAQC,MACN,YAAYR,EAASK,KAAKE,SAAW,SAG3C,CAAE,MAAOC,GACPL,QAAQK,MAAM,YAAaA,GAC3BD,EAAAA,GAAQC,MAAM,WAChB,CAAE,QACAhB,GAAW,EACb,IAGFiB,EAAAA,EAAAA,YAAU,KACRX,GAAgB,GACf,IAGH,MA6BMY,EAAU,CACd,CACEC,MAAO,MACPC,UAAW,WACXC,IAAK,WACLC,cAAe,CAAClB,GAChBmB,SAAUA,CAACC,EAAeC,IACxBA,EAAOC,SAASC,cAAcC,SAASJ,EAAMG,gBAEjD,CACER,MAAO,KACPC,UAAW,QACXC,IAAK,SAEP,CACEF,MAAO,KACPC,UAAW,QACXC,IAAK,SAEP,CACEF,MAAO,KACPC,UAAW,aACXC,IAAK,cAEP,CACEF,MAAO,OACPC,UAAW,YACXC,IAAK,aAEP,CACEF,MAAO,KACPC,UAAW,SACXC,IAAK,UAEP,CACEF,MAAO,OACPC,UAAW,iBACXC,IAAK,kBAEP,CACEF,MAAO,KACPE,IAAK,SACLQ,OAAQA,CAACC,EAAuBL,IAC9BM,EAAAA,cAACC,EAAAA,GAAM,CACLC,QAAM,EACNC,QAASA,IA1EE3B,WACjB4B,EAAAA,EAAMC,QAAQ,CACZjB,MAAO,OACPkB,QAAS,cACTC,OAAQ,KACRC,WAAY,KACZC,KAAMjC,UACJ,IACE,MAAMC,QAAiBC,EAAAA,EAAQgC,IAAI,UAAUC,IAAc,CACzDC,OAAQ,WACRC,KAAM,SAGmB,MAAvBpC,EAASK,KAAKC,MAChBC,EAAAA,GAAQ8B,QAAQ,SAEhBvC,KAEAS,EAAAA,GAAQC,MAAM,QAAQR,EAASK,KAAKE,SAAW,SAEnD,CAAE,MAAOC,GACPL,QAAQK,MAAM,UAAWA,GACzBD,EAAAA,GAAQC,MAAM,SAChB,IAEF,EAiDmB8B,CAAWrB,EAAOJ,KACjC0B,SAA4B,UAAlBtB,EAAOkB,QAClB,QAQDK,EAAe9C,EAAU+C,QAC5BC,GAA+B,aAAlBA,EAASN,OAGzB,OAAI7C,EACKgC,EAAAA,cAACoB,EAAAA,EAAI,CAACC,KAAK,UAGflD,GAAkC,IAArBA,EAAUmD,OAIA,IAAxBL,EAAaK,OACRtB,EAAAA,cAAA,WAAK,aAIZA,EAAAA,cAAA,WACEA,EAAAA,cAAA,UAAI,QACJA,EAAAA,cAACuB,EAAAA,EAAK,CAACC,MAAO,CAAEC,aAAc,KAC5BzB,EAAAA,cAAC0B,EAAAA,EAAK,CACJC,YAAY,SACZlC,MAAOpB,EACPuD,SAAWC,GAAMvD,EAAcuD,EAAEC,OAAOrC,OACxCsC,OAAQ/B,EAAAA,cAACgC,EAAAA,EAAc,MACvBR,MAAO,CAAES,MAAO,OAElBjC,EAAAA,cAACC,EAAAA,GAAM,CAACE,QAASA,IAAM7B,EAAc,KAAK,SAE5C0B,EAAAA,cAACkC,EAAAA,EAAK,CACJC,WAAYlB,EACZ9B,QAASA,EACTiD,OAAO,MACPC,WAAY,CAAEC,SAAU,OAxBrBtC,EAAAA,cAAA,WAAK,UA0BN,ECrKV,EAJuBuC,IACdvC,EAAAA,cAACwC,EAAS,K","sources":["webpack://my_pra/./src/components/UserTable.tsx","webpack://my_pra/./src/pages/User.tsx"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\r\nimport { Card, Spin, message, Table, Input, Button, Modal, Space } from \"antd\";\r\nimport { SearchOutlined } from \"@ant-design/icons\";\r\nimport request from \"../utils/request\";\r\n\r\ninterface EmployeeType {\r\n  key: string;\r\n  username: string;\r\n  email: string;\r\n  phone: string;\r\n  role: string;\r\n  status: string;\r\n  department: string;\r\n  departmentId: string;\r\n  entryDate: string;\r\n  employmentType: string;\r\n  avatar: string;\r\n  createdAt: string;\r\n}\r\n\r\nconst UserDetail: React.FC = () => {\r\n  const [loading, setLoading] = useState(true);\r\n  const [employees, setEmployees] = useState<EmployeeType[]>([]);\r\n  const [searchText, setSearchText] = useState(\"\");\r\n\r\n  // 获取所有用户数据\r\n  const fetchEmployees = async () => {\r\n    setLoading(true);\r\n    try {\r\n      const response = await request.get(\"/users\");\r\n      console.log(\"API Response:\", response.data);\r\n\r\n      if (response.data.code === 200) {\r\n        setEmployees(response.data.data);\r\n      } else {\r\n        message.error(\r\n          `获取员工信息失败：${response.data.message || \"未知错误\"}`\r\n        );\r\n      }\r\n    } catch (error) {\r\n      console.error(\"获取员工信息失败:\", error);\r\n      message.error(\"获取员工信息失败\");\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    fetchEmployees();\r\n  }, []);\r\n\r\n  // 解雇员工\r\n  const handleFire = async (employeeId: string) => {\r\n    Modal.confirm({\r\n      title: \"确认解雇\",\r\n      content: \"您确定要解雇该员工吗？\",\r\n      okText: \"确认\",\r\n      cancelText: \"取消\",\r\n      onOk: async () => {\r\n        try {\r\n          const response = await request.put(`/users/${employeeId}`, {\r\n            status: \"inactive\",\r\n            role: \"user\",\r\n          });\r\n\r\n          if (response.data.code === 200) {\r\n            message.success(\"员工已解雇\");\r\n            // 更新员工列表\r\n            fetchEmployees();\r\n          } else {\r\n            message.error(`解雇失败：${response.data.message || \"未知错误\"}`);\r\n          }\r\n        } catch (error) {\r\n          console.error(\"解雇员工失败:\", error);\r\n          message.error(\"解雇员工失败\");\r\n        }\r\n      },\r\n    });\r\n  };\r\n\r\n  // 表格列定义\r\n  const columns = [\r\n    {\r\n      title: \"用户名\",\r\n      dataIndex: \"username\",\r\n      key: \"username\",\r\n      filteredValue: [searchText],\r\n      onFilter: (value: string, record: EmployeeType) =>\r\n        record.username.toLowerCase().includes(value.toLowerCase()),\r\n    },\r\n    {\r\n      title: \"邮箱\",\r\n      dataIndex: \"email\",\r\n      key: \"email\",\r\n    },\r\n    {\r\n      title: \"电话\",\r\n      dataIndex: \"phone\",\r\n      key: \"phone\",\r\n    },\r\n    {\r\n      title: \"部门\",\r\n      dataIndex: \"department\",\r\n      key: \"department\",\r\n    },\r\n    {\r\n      title: \"入职日期\",\r\n      dataIndex: \"entryDate\",\r\n      key: \"entryDate\",\r\n    },\r\n    {\r\n      title: \"状态\",\r\n      dataIndex: \"status\",\r\n      key: \"status\",\r\n    },\r\n    {\r\n      title: \"雇佣类型\",\r\n      dataIndex: \"employmentType\",\r\n      key: \"employmentType\",\r\n    },\r\n    {\r\n      title: \"操作\",\r\n      key: \"action\",\r\n      render: (text: React.ReactNode, record: EmployeeType) => (\r\n        <Button\r\n          danger\r\n          onClick={() => handleFire(record.key)}\r\n          disabled={record.status === \"fired\"}\r\n        >\r\n          解雇\r\n        </Button>\r\n      ),\r\n    },\r\n  ];\r\n\r\n  // 筛选出role为employee的用户\r\n  const employeeOnly = employees.filter(\r\n    (employee) => employee.role === \"employee\"\r\n  );\r\n\r\n  if (loading) {\r\n    return <Spin size=\"large\" />;\r\n  }\r\n\r\n  if (!employees || employees.length === 0) {\r\n    return <div>未找到员工信息</div>;\r\n  }\r\n\r\n  if (employeeOnly.length === 0) {\r\n    return <div>未找到普通员工信息</div>;\r\n  }\r\n\r\n  return (\r\n    <div>\r\n      <h1>员工列表</h1>\r\n      <Space style={{ marginBottom: 16 }}>\r\n        <Input\r\n          placeholder=\"搜索员工姓名\"\r\n          value={searchText}\r\n          onChange={(e) => setSearchText(e.target.value)}\r\n          prefix={<SearchOutlined />}\r\n          style={{ width: 200 }}\r\n        />\r\n        <Button onClick={() => setSearchText(\"\")}>清除搜索</Button>\r\n      </Space>\r\n      <Table\r\n        dataSource={employeeOnly}\r\n        columns={columns}\r\n        rowKey=\"key\"\r\n        pagination={{ pageSize: 10 }}\r\n      />\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default UserDetail;\r\n","import React from \"react\";\r\nimport UserTable from \"../components/UserTable\";\r\nconst User: React.FC = () => {\r\n  return <UserTable />;\r\n};\r\n\r\nexport default User;\r\n"],"names":["UserDetail","loading","setLoading","useState","employees","setEmployees","searchText","setSearchText","fetchEmployees","async","response","request","get","console","log","data","code","message","error","useEffect","columns","title","dataIndex","key","filteredValue","onFilter","value","record","username","toLowerCase","includes","render","text","React","Button","danger","onClick","Modal","confirm","content","okText","cancelText","onOk","put","employeeId","status","role","success","handleFire","disabled","employeeOnly","filter","employee","Spin","size","length","Space","style","marginBottom","Input","placeholder","onChange","e","target","prefix","SearchOutlined","width","Table","dataSource","rowKey","pagination","pageSize","User","UserTable"],"sourceRoot":""}